{
  "comments": [
    {
      "key": {
        "uuid": "bd2f2c18_4810f19b",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 2008,
      "author": {
        "id": 1000116
      },
      "writtenOn": "2020-06-01T07:58:47Z",
      "side": 1,
      "message": "I\u0027m wondering if we shoudl unlock after alle the events at line 2015",
      "range": {
        "startLine": 2008,
        "startChar": 2,
        "endLine": 2008,
        "endChar": 25
      },
      "revId": "b589761d8ded26e4f303f273589d0b5ddbb63f22",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4f872bc7_5645893c",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 2008,
      "author": {
        "id": 1000127
      },
      "writtenOn": "2020-06-01T22:00:39Z",
      "side": 1,
      "message": "This is on the similar lines as done in function waitForFlowRemoveToFinish.\nThis is a lock per device. We want to serialize operations on a per subscriber basis and not on per OLT device basis.\nMoving the lock to the line you suggested will serialize operation on a per OLT device basis (which is not necessary) and also slow down things.",
      "parentUuid": "bd2f2c18_4810f19b",
      "range": {
        "startLine": 2008,
        "startChar": 2,
        "endLine": 2008,
        "endChar": 25
      },
      "revId": "b589761d8ded26e4f303f273589d0b5ddbb63f22",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "409fd456_f73c81d1",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 2013,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2020-06-03T18:34:33Z",
      "side": 1,
      "message": "Does pendingFlowRemoveDataPerSubscriber() also removes the key from the map?  Otherwise, if you get two concurrent ChildDeviceLost requests for the same onu then only one may receive a notification that all flows are removed while the other one wait forever.   I have not look at other areas of the code so I may be completely incorrect.",
      "revId": "b589761d8ded26e4f303f273589d0b5ddbb63f22",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c1aae48b_18df123b",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 2013,
      "author": {
        "id": 1000127
      },
      "writtenOn": "2020-06-03T18:57:17Z",
      "side": 1,
      "message": "The \u0027key\u0027 is removed from pendingFlowRemoveDataPerSubscriber map in function decrementActiveFlowRemoveCount and it also closes the \u0027allFlowsRemoved\u0027 channel. If there were two concurrent ChildDeviceLost, then both handlers waiting on this closed channel would succeed.\nLet me know if I misunderstood your question.",
      "parentUuid": "409fd456_f73c81d1",
      "revId": "b589761d8ded26e4f303f273589d0b5ddbb63f22",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388",
      "unresolved": false
    }
  ]
}