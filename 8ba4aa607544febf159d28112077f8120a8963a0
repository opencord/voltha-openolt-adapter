{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "db70f22d_f1a01aea",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 1818,
      "author": {
        "id": 1000404
      },
      "writtenOn": "2025-07-30T13:55:20Z",
      "side": 1,
      "message": "I could not understand why this boolean flag is needed. CheckOnuDevExistenceAtOnuDiscovery is already for this purpose? The same purpose could still be achived by using the CheckOnuDevExistenceAtOnuDiscovery flag.",
      "revId": "8ba4aa607544febf159d28112077f8120a8963a0",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "787d7843_48e976e4",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 1818,
      "author": {
        "id": 1000960
      },
      "writtenOn": "2025-07-30T14:08:56Z",
      "side": 1,
      "message": "CheckOnuDevExistenceAtOnuDiscovery flag is used to check if the TP instance exists for the ONU device. If the TP inst exists in olt-adapter, we do not further process the discovery indication. If this flag is disabled, we will check if the ONU device exists in rw-core. If the device exists in rw-core, the olt-adapter will skip processing the discovery indication.\n\nFor the onu-reboot enhancement, we want the ONU discovery indication to be processed irrespective of whether the TP inst exists in the adapter or the device exists in rw-core. Hence the new flag will force the olt-adapter to proceed with processing the ONU discovery indication.",
      "parentUuid": "db70f22d_f1a01aea",
      "revId": "8ba4aa607544febf159d28112077f8120a8963a0",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f5b29724_30d23bef",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 1818,
      "author": {
        "id": 1000404
      },
      "writtenOn": "2025-07-30T21:07:15Z",
      "side": 1,
      "message": "The flag CheckOnuDevExistenceAtOnuDiscovery seems to be an inverted control for checkForResourceExistance\u0027s core logic. If CheckOnuDevExistenceAtOnuDiscovery is true, it effectively disables the \"check for resource existence\" behavior.\nThe simplest and most logical refactoring is to remove CheckOnuDevExistenceAtOnuDiscovery and rely only on ForceOnuDiscIndProcessing to decide whether to perform the checkForResourceExistance logic at all.\nIt seems that also the comment above the CheckOnuDevExistenceAtOnuDiscovery is wrong:\n\n// CheckOnuDevExistenceAtOnuDiscovery if true , a check will be made for the existence of the onu device. If the onu device still exists , the onu discovery will be ignored, else a check for active techprofiles for ONU is checked.\nif !dh.openOLT.CheckOnuDevExistenceAtOnuDiscovery {\n // checks the resource existence here.. but the flag is inverted!",
      "parentUuid": "787d7843_48e976e4",
      "revId": "8ba4aa607544febf159d28112077f8120a8963a0",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dd47b614_79971609",
        "filename": "internal/pkg/core/device_handler.go",
        "patchSetId": 2
      },
      "lineNbr": 1818,
      "author": {
        "id": 1000537
      },
      "writtenOn": "2025-07-31T08:01:33Z",
      "side": 1,
      "message": "We have 3 cases to handle now \n case 1: check for tpinstance , which should be default behavior. before proceeding with onu discovery check for tpinstance\n case 2: check for device , this we need to check if the device is existing in core before accepting discovery. if there is no device then it is obvious that all tps and flows also will be deleted.\n case 3: dont check anything , this is needed for our reboot optimization \n \n inorder to handle all 3 scenrios we would need 2 flags, agree it is 1 extar flag to handle similar scenarios but easy way instead of complicating the logic\n if CheckOnuDevExistenceAtOnuDiscovery is set to true then case 2 will be checked , if it is set to false then case 1 will be checked by default.\n if ForceOnuDiscIndProcessing is set to true then CheckOnuDevExistenceAtOnuDiscovery will be ignored .\n if both CheckOnuDevExistenceAtOnuDiscovery and CheckOnuDevExistenceAtOnuDiscovery are false then it will be case 1 , TP check only by default.\n \n I think we will put better documentation in helmcharts and in adapter config file to be clear \n\nPlease share if you have other ideas",
      "parentUuid": "f5b29724_30d23bef",
      "revId": "8ba4aa607544febf159d28112077f8120a8963a0",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    }
  ]
}